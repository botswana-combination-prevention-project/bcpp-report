{% extends 'edc_base/base.html' %}

{% load crispy_forms_tags %}

{% block extra-scripts %}
	{{ block.super }}
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	<style type="text/css">
          #exTab1 .tab-content {
			  color : white;
			  background-color: #428bca;
			  padding : 5px 15px;
			}
     </style>
{% endblock extra-scripts %}


{% block main %}
{{ block.super }}
<div id="exTab2" class="container">	
	<div class="raw">
		<div id="div-home-right" class="col-md-12">
			<div id="div-home-right" class="col-md-9">
    			<div class="panel panel-default">
					<div class="panel-heading">Generate Reporting files</div>
					<div class="panel-body">
						<a href="{% url 'bcpp_report:generate_report_files_url' %}?generate=all" role="button" class="btn btn-sm btn-default">Generate files All communities</a>
						<span class="pull-right">
							<form id="generate_files" action="{% url 'bcpp_report:generate_report_files_url' %}?generate=specific" method="post">
								{% csrf_token %}
								{{ form }}
								<input type="submit" value="Generate community report files" class="btn btn-sm btn-default">
							</form>
						</span>
						<br />
						<hr />
						NB: Generating files may take some time, u may want to see reports from files already generated files.
						<hr />
						{% if report_files %}
						<table id="item-identifiers" class="table table-striped table-bordered" cellspacing="0" width="100%">
							<thead>
								<tr>
									<th>File name</th>
									<th>Date time generated</th>
									<th>Community</th>
								</tr>
							</thead>
							<tfoot>
								<tr>
									<th>File name</th>
									<th>Date time generated</th>
									<th>Community</th>
								</tr>
							</tfoot>
							<tbody>
								{% for name, date, community in report_files %}
					      		<tr>
					      			<td>{{name}}</td>
					      			<td>{{date}}</td>
					      			<td>{{community}}</td>
					      		</tr>
					      		{% endfor %}
							</tbody>
						</table>
						{% else %}
							<p>There are no report files, please generate files.</p>
						{% endif %}
					</div>
				</div>
			</div>
			<div id="div-home-right" class="col-md-3">
    			<div class="panel panel-default">
					<div class="panel-heading">View Reports</div>
					<div class="panel-body">
						<a role="button" class="btn btn-sm btn-default btn-block" href="{% url 'bcpp_report:reports_view_url' %}">View Reports</a>
						<a role="button" class="btn btn-sm btn-default btn-block" href="{% url 'bcpp_report:bcpp_report_admin:index' %}">Report Admin</a>
					</div>
				</div>
			</div>
    	</div>
    </div>
</div>
{% endblock main %}

